# Story 4.2: Inventory Import & Validation

## Status
Draft

## Story
**As a** vendor,
**I want** to upload inventory via CSV/API,
**so that** my listings stay current automatically.

## Acceptance Criteria
1. AC1: Upload endpoint accepts CSV with schema validation and error feedback before import.
2. AC2: Transformation mapping resolves SKUs to catalog card IDs, returning unresolved items for review.
3. AC3: Bulk upsert operations run in transactional batches with rollback on failure.
4. AC4: Success and error notifications surfaced in vendor panel with downloadable reports.

## Tasks / Subtasks
- [ ] Implement CSV upload API + schema validation (headers, datatypes) with pre-flight error response (AC1).
- [ ] Create transformation pipeline mapping SKUs to catalog IDs and producing unresolved report (AC2).
- [ ] Execute bulk upserts in transactional batches with retry and rollback handling (AC3).
- [ ] Surface job status, success, and error downloads in vendor panel UI (AC4).
- [ ] Provide REST endpoint for programmatic inventory submission (API) with same validation stack (AC1-AC3).
- [ ] Update vendor documentation and sample CSV templates (AC1-AC4).

## Dev Notes
- Backend module `backend/src/modules/vendor-management/inventory-import` should host validation + transformation logic.
- Use streaming parser for large CSV files; enforce file size limits.
- Queue processing (BullMQ) ensures asynchronous ingestion; store job metadata in DB.
- Vendor panel page `vendorpanel/src/pages/inventory/import` to show upload progress and downloadable reports.
- Reports stored in MinIO with signed download URLs; ensure cleanup policy.

## Testing
- Unit tests for CSV schema validation and SKU mapping.
- Integration tests covering full ingest cycle with success + error cases.
- Playwright test: vendor uploads CSV, views status, downloads error report.
- Load test for large file ingestion to ensure throughput and memory usage acceptable.

## Change Log
| Date       | Version | Description              | Author |
|------------|---------|--------------------------|--------|
| 2025-09-13 | 0.1.0   | Initial story draft      | Codex  |

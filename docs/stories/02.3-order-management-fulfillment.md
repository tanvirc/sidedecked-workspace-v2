# Story 2.3: Order Management & Fulfillment

## Status
Draft

## Story
**As a** customer,
**I want** to track my orders through fulfillment,
**so that** I understand progress and can take action when needed.

## Acceptance Criteria
1. AC1: Orders list page shows status timeline (processing, shipped, delivered, cancelled) with events.
2. AC2: Backend ingests fulfillment updates from vendors and syncs to storefront via webhooks.
3. AC3: Customers can request cancellations or returns within policy windows.
4. AC4: Email notifications triggered for status changes with templated messaging.

## Tasks / Subtasks
- [ ] Build orders list/detail UI displaying timeline component and vendor-level status (AC1).
- [ ] Implement webhook handlers updating order status from vendor/fulfillment providers (AC2).
- [ ] Add APIs + UI for cancellation/return requests with policy validations (AC3).
- [ ] Configure notification service to send templated emails on status changes (AC4).
- [ ] Update order history data model to store timeline events with metadata (AC1-AC2).
- [ ] Document support workflow for manual order interventions (AC3-AC4).

## Dev Notes
- Storefront orders route: `storefront/src/app/(auth)/orders`. Timeline component may live under `storefront/src/components/orders/`.
- Backend webhook endpoints likely under `backend/src/api/store/orders/webhooks`; ensure signature verification.
- Vendor panel should expose APIs to trigger shipment updates—coordinate with Epic 04 automation.
- Cancellation policy windows stored in config; enforce via service layer and log overrides.
- Email templates stored in `backend/src/templates/email/orders`—add new events and translations.

## Testing
- Unit tests for status transition logic and cancellation window validation.
- Integration tests for webhook ingestion with sample payloads.
- Playwright scenario: view order timeline, request cancellation, receive email stub.
- QA to verify emails rendered correctly using staging mail catcher.

## Change Log
| Date       | Version | Description              | Author |
|------------|---------|--------------------------|--------|
| 2025-09-13 | 0.1.0   | Initial story draft      | Codex  |

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SideDecked ‚Äî Story 2-3: Algolia Search Wireframe</title>
<style>
/* ============================================================
   DESIGN TOKENS ‚Äî Midnight Forge
   ============================================================ */
:root {
  --bg-base: #0C0D12;
  --bg-surface-1: #13141A;
  --bg-surface-2: #1A1C24;
  --bg-surface-3: #22242E;
  --bg-surface-4: #2A2D38;
  --accent-primary: #D4A843;
  --accent-primary-hover: #E0B94F;
  --interactive: #7C8CFF;
  --interactive-hover: #9BA6FF;
  --positive: #4ADE80;
  --negative: #EF5350;
  --warning: #FBBF24;
  --text-primary: #E8ECF1;
  --text-secondary: #8B93A6;
  --text-tertiary: #4F5568;
  --text-price: #D4A843;
  --border-subtle: rgba(255,255,255,0.06);
  --border-default: rgba(255,255,255,0.10);
  --radius-sm: 6px;
  --radius-md: 10px;
  --radius-lg: 16px;
  --radius-xl: 24px;
  --sp-1: 4px; --sp-2: 8px; --sp-3: 12px; --sp-4: 16px;
  --sp-5: 24px; --sp-6: 32px; --sp-7: 48px;
  --game-mtg: #A855F7;
  --game-pokemon: #FBBF24;
  --game-yugioh: #60A5FA;
  --game-optcg: #34D399;
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html {
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  font-size: 14px; line-height: 1.5;
  color: var(--text-primary); background: var(--bg-base);
  -webkit-font-smoothing: antialiased;
}
body { min-height: 100vh; }

/* ============================================================
   HEADER
   ============================================================ */
.showcase-header {
  text-align: center;
  padding: var(--sp-7) var(--sp-5) var(--sp-6);
  border-bottom: 1px solid var(--border-subtle);
  background: var(--bg-surface-1);
}
.showcase-header h1 { font-size: 28px; font-weight: 700; letter-spacing: -0.02em; }
.showcase-header h1 span { color: var(--accent-primary); }
.showcase-header p { margin-top: var(--sp-2); font-size: 13px; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.06em; font-weight: 500; }
.story-meta { display: flex; justify-content: center; gap: var(--sp-3); margin-top: var(--sp-4); flex-wrap: wrap; }
.meta-chip { padding: var(--sp-1) var(--sp-3); border: 1px solid var(--border-default); border-radius: var(--radius-xl); font-size: 12px; color: var(--text-secondary); }
.meta-chip.warn { border-color: rgba(251,191,36,0.3); color: var(--warning); background: rgba(251,191,36,0.06); }

/* ============================================================
   TAB NAV
   ============================================================ */
.tab-nav {
  display: flex; justify-content: center; gap: var(--sp-2);
  padding: var(--sp-4) var(--sp-5); background: var(--bg-surface-1);
  border-bottom: 1px solid var(--border-subtle);
  flex-wrap: wrap; position: sticky; top: 0; z-index: 100;
}
.tab-btn {
  display: inline-flex; align-items: center; gap: var(--sp-2);
  padding: var(--sp-2) var(--sp-4); border: 1px solid var(--border-default);
  border-radius: var(--radius-xl); background: transparent;
  color: var(--text-secondary); font-size: 13px; font-weight: 500;
  cursor: pointer; transition: all 0.2s ease; white-space: nowrap; font-family: inherit;
}
.tab-btn:hover { color: var(--text-primary); border-color: var(--interactive); background: rgba(124,140,255,0.06); }
.tab-btn.active { color: var(--bg-base); background: var(--accent-primary); border-color: var(--accent-primary); }
.tab-btn .num { display: inline-flex; align-items: center; justify-content: center; width: 18px; height: 18px; border-radius: 50%; font-size: 10px; font-weight: 700; background: rgba(255,255,255,0.12); }
.tab-btn.active .num { background: rgba(0,0,0,0.2); color: var(--bg-base); }

/* ============================================================
   PANEL CONTAINER
   ============================================================ */
.panels { padding: var(--sp-6) var(--sp-5) var(--sp-7); }
.panel { display: none; max-width: 1100px; margin: 0 auto; animation: fadeIn 0.25s ease; }
.panel.active { display: block; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: translateY(0); } }

.panel-label {
  display: inline-block; padding: var(--sp-1) var(--sp-3); border-radius: var(--radius-sm);
  background: rgba(124,140,255,0.10); color: var(--interactive);
  font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: var(--sp-3);
}
.panel-title { font-size: 22px; font-weight: 700; letter-spacing: -0.01em; margin-bottom: var(--sp-2); }
.panel-desc { font-size: 13px; color: var(--text-secondary); margin-bottom: var(--sp-6); max-width: 600px; line-height: 1.6; }

/* ============================================================
   ANNOTATION SYSTEM
   ============================================================ */
.annotation {
  position: absolute; background: rgba(124,140,255,0.15); border: 1px solid rgba(124,140,255,0.35);
  border-radius: var(--radius-sm); padding: 3px 8px;
  font-size: 11px; color: var(--interactive); font-weight: 500; white-space: nowrap; z-index: 10;
}
.annotation.accent { background: rgba(212,168,67,0.12); border-color: rgba(212,168,67,0.35); color: var(--accent-primary); }
.annotation.positive { background: rgba(74,222,128,0.10); border-color: rgba(74,222,128,0.3); color: var(--positive); }
.annotation.warn { background: rgba(251,191,36,0.10); border-color: rgba(251,191,36,0.3); color: var(--warning); }

/* ============================================================
   DEVICE FRAMES
   ============================================================ */
.frame-row { display: flex; gap: var(--sp-6); align-items: flex-start; flex-wrap: wrap; margin-bottom: var(--sp-6); }
.frame-col { flex: 1; min-width: 280px; }
.frame-col.narrow { max-width: 375px; }
.frame-col.wide { flex: 2; }

.device-label { font-size: 11px; font-weight: 600; color: var(--text-tertiary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: var(--sp-3); }

.screen {
  background: var(--bg-surface-1); border: 1px solid var(--border-default);
  border-radius: var(--radius-lg); overflow: hidden; position: relative;
}
.screen-chrome {
  background: var(--bg-surface-2); padding: var(--sp-3) var(--sp-4);
  border-bottom: 1px solid var(--border-subtle);
  display: flex; align-items: center; gap: var(--sp-3);
}
.chrome-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--bg-surface-4); }
.chrome-url { flex: 1; text-align: center; font-size: 11px; color: var(--text-tertiary); font-family: monospace; }

/* ============================================================
   WIREFRAME COMPONENTS
   ============================================================ */

/* NAV BAR */
.nav-bar {
  background: var(--bg-surface-2); border-bottom: 1px solid var(--border-subtle);
  padding: 0 var(--sp-4); height: 56px;
  display: flex; align-items: center; gap: var(--sp-4);
}
.nav-logo { font-size: 15px; font-weight: 700; color: var(--accent-primary); white-space: nowrap; letter-spacing: -0.01em; }
.nav-logo span { color: var(--text-primary); }

/* SEARCH TRIGGER (collapsed, nav-level) */
.search-trigger {
  flex: 1; max-width: 420px; height: 36px;
  background: var(--bg-surface-3); border: 1px solid var(--border-default);
  border-radius: var(--radius-xl); display: flex; align-items: center;
  padding: 0 var(--sp-3) 0 var(--sp-3); gap: var(--sp-2);
  cursor: text; transition: border-color 0.2s;
}
.search-trigger:hover { border-color: var(--interactive); }
.search-trigger-icon { color: var(--text-tertiary); font-size: 14px; }
.search-trigger-text { flex: 1; font-size: 13px; color: var(--text-tertiary); }
.kbd-shortcut {
  display: inline-flex; align-items: center; gap: 2px;
  font-size: 10px; color: var(--text-tertiary);
  border: 1px solid var(--border-default); border-radius: 4px;
  padding: 1px 5px; font-family: monospace; background: var(--bg-surface-4);
}
.nav-actions { display: flex; align-items: center; gap: var(--sp-3); margin-left: auto; }
.nav-avatar { width: 28px; height: 28px; border-radius: 50%; background: var(--bg-surface-4); border: 1px solid var(--border-default); }
.nav-btn { font-size: 12px; color: var(--text-secondary); cursor: pointer; padding: var(--sp-2) var(--sp-3); border-radius: var(--radius-sm); background: transparent; border: 1px solid var(--border-default); }

/* SEARCH EXPANDED (cmdk overlay) */
.cmdk-overlay {
  position: absolute; top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(12,13,18,0.85); backdrop-filter: blur(4px);
  z-index: 50; display: flex; align-items: flex-start; justify-content: center;
  padding-top: 80px;
}
.cmdk-dialog {
  width: 560px; max-width: calc(100% - 32px);
  background: var(--bg-surface-2); border: 1px solid var(--border-default);
  border-radius: var(--radius-lg); box-shadow: 0 24px 64px rgba(0,0,0,0.6);
  overflow: hidden;
}
.cmdk-input-row {
  display: flex; align-items: center; gap: var(--sp-3); padding: var(--sp-3) var(--sp-4);
  border-bottom: 1px solid var(--border-subtle);
}
.cmdk-input-icon { color: var(--text-secondary); font-size: 16px; }
.cmdk-input {
  flex: 1; background: transparent; border: none; outline: none;
  font-size: 15px; color: var(--text-primary); font-family: inherit;
  caret-color: var(--interactive);
}
.cmdk-esc { font-size: 10px; color: var(--text-tertiary); border: 1px solid var(--border-default); border-radius: 4px; padding: 2px 6px; font-family: monospace; }

/* SUGGESTIONS */
.suggestions-header {
  padding: var(--sp-2) var(--sp-4); font-size: 11px; color: var(--text-tertiary);
  text-transform: uppercase; letter-spacing: 0.08em; font-weight: 600;
  display: flex; justify-content: space-between; align-items: center;
}
.suggestions-clear { font-size: 11px; color: var(--interactive); cursor: pointer; text-transform: none; letter-spacing: 0; }

.suggestion-item {
  display: flex; align-items: center; gap: var(--sp-3);
  padding: var(--sp-3) var(--sp-4); cursor: pointer;
  transition: background 0.15s; border-radius: 0;
}
.suggestion-item:hover, .suggestion-item.active { background: var(--bg-surface-3); }

.suggestion-thumb {
  width: 36px; height: 50px; border-radius: var(--radius-sm);
  background: var(--bg-surface-4); flex-shrink: 0;
  border: 1px solid var(--border-subtle); overflow: hidden;
  display: flex; align-items: center; justify-content: center;
}
.thumb-img { width: 100%; height: 100%; object-fit: cover; }
.thumb-placeholder { font-size: 18px; color: var(--text-tertiary); }

.suggestion-body { flex: 1; min-width: 0; }
.suggestion-name { font-size: 14px; color: var(--text-primary); font-weight: 500; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.suggestion-name mark { background: transparent; color: var(--accent-primary); }
.suggestion-meta { display: flex; align-items: center; gap: var(--sp-2); margin-top: 2px; }
.suggestion-set { font-size: 12px; color: var(--text-secondary); }

/* GAME BADGE */
.game-badge {
  display: inline-flex; align-items: center;
  padding: 1px 7px; border-radius: var(--radius-xl);
  font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.04em;
}
.game-badge.mtg { background: rgba(168,85,247,0.15); color: var(--game-mtg); border: 1px solid rgba(168,85,247,0.25); }
.game-badge.pokemon { background: rgba(251,191,36,0.12); color: var(--game-pokemon); border: 1px solid rgba(251,191,36,0.2); }
.game-badge.yugioh { background: rgba(96,165,250,0.12); color: var(--game-yugioh); border: 1px solid rgba(96,165,250,0.2); }
.game-badge.optcg { background: rgba(52,211,153,0.12); color: var(--game-optcg); border: 1px solid rgba(52,211,153,0.2); }

.suggestion-price { font-size: 13px; font-weight: 600; color: var(--text-price); white-space: nowrap; }
.suggestion-type-icon {
  width: 36px; height: 36px; border-radius: var(--radius-md); flex-shrink: 0;
  display: flex; align-items: center; justify-content: center; font-size: 16px;
}
.suggestion-type-icon.set { background: rgba(74,222,128,0.08); }
.suggestion-type-icon.recent { background: rgba(139,147,166,0.08); }

.suggestions-footer {
  padding: var(--sp-3) var(--sp-4); border-top: 1px solid var(--border-subtle);
  font-size: 12px; color: var(--text-tertiary);
  display: flex; gap: var(--sp-4);
}
.suggestions-footer span { display: inline-flex; align-items: center; gap: 4px; }
.kbd { border: 1px solid var(--border-default); border-radius: 3px; padding: 1px 4px; font-size: 10px; font-family: monospace; background: var(--bg-surface-3); color: var(--text-tertiary); }

/* RESULTS PAGE */
.results-page { background: var(--bg-surface-1); }
.results-header {
  padding: var(--sp-5) var(--sp-5) var(--sp-4);
  border-bottom: 1px solid var(--border-subtle);
}
.results-search-row { display: flex; align-items: center; gap: var(--sp-3); }
.results-search-box {
  flex: 1; max-width: 480px; height: 40px;
  background: var(--bg-surface-2); border: 1px solid var(--interactive);
  border-radius: var(--radius-xl); display: flex; align-items: center;
  padding: 0 var(--sp-4); gap: var(--sp-2);
  box-shadow: 0 0 0 3px rgba(124,140,255,0.12);
}
.results-search-query { font-size: 14px; color: var(--text-primary); }
.results-search-clear { width: 18px; height: 18px; border-radius: 50%; background: var(--bg-surface-4); display: flex; align-items: center; justify-content: center; font-size: 10px; cursor: pointer; color: var(--text-secondary); margin-left: auto; }

.results-meta-row { display: flex; align-items: center; gap: var(--sp-3); margin-top: var(--sp-3); }
.results-count { font-size: 13px; color: var(--text-secondary); }
.results-count strong { color: var(--text-primary); }
.sort-select {
  padding: var(--sp-2) var(--sp-3); background: var(--bg-surface-2);
  border: 1px solid var(--border-default); border-radius: var(--radius-sm);
  font-size: 12px; color: var(--text-secondary); cursor: pointer; font-family: inherit;
}

/* DID YOU MEAN BANNER */
.did-you-mean {
  margin: var(--sp-4) var(--sp-5) 0;
  background: rgba(124,140,255,0.08); border: 1px solid rgba(124,140,255,0.2);
  border-radius: var(--radius-md); padding: var(--sp-3) var(--sp-4);
  font-size: 13px; color: var(--text-secondary);
}
.did-you-mean a { color: var(--interactive); text-decoration: underline; cursor: pointer; font-weight: 500; }

/* RESULTS GRID */
.results-content { display: flex; gap: var(--sp-5); padding: var(--sp-5); }
.results-main { flex: 1; }
.results-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
  gap: var(--sp-4);
}

/* CARD ITEM (Algolia hit ‚Üí CardDisplay) */
.card-item {
  background: var(--bg-surface-2); border: 1px solid var(--border-subtle);
  border-radius: var(--radius-md); overflow: hidden; cursor: pointer;
  transition: border-color 0.2s, transform 0.2s;
}
.card-item:hover { border-color: var(--border-default); transform: translateY(-2px); }
.card-img-wrap {
  aspect-ratio: 63/88; background: var(--bg-surface-3); position: relative;
  overflow: hidden;
}
.card-img-placeholder {
  width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;
  font-size: 32px; color: var(--text-tertiary);
}
.card-rarity-pip {
  position: absolute; top: 6px; right: 6px; width: 10px; height: 10px;
  border-radius: 50%; border: 1px solid rgba(0,0,0,0.4);
}
.rarity-rare { background: var(--accent-primary); }
.rarity-mythic { background: #E85D26; }
.rarity-common { background: #6B6B6B; }
.rarity-uncommon { background: #A8B4C0; }

.card-info { padding: var(--sp-3); }
.card-name { font-size: 12px; font-weight: 600; color: var(--text-primary); margin-bottom: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.card-set { font-size: 11px; color: var(--text-secondary); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.card-price-row { display: flex; align-items: center; justify-content: space-between; margin-top: var(--sp-2); }
.card-price { font-size: 13px; font-weight: 700; color: var(--text-price); }
.card-sellers { font-size: 11px; color: var(--text-tertiary); }
.card-game-badge { margin-top: var(--sp-2); }

/* LOADING SKELETON */
.skeleton {
  background: linear-gradient(90deg, var(--bg-surface-3) 25%, var(--bg-surface-4) 50%, var(--bg-surface-3) 75%);
  background-size: 200% 100%;
  animation: shimmer 1.5s infinite;
  border-radius: var(--radius-sm);
}
@keyframes shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
.skeleton-card { background: var(--bg-surface-2); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); overflow: hidden; }
.skeleton-img { aspect-ratio: 63/88; }
.skeleton-line { height: 10px; margin: var(--sp-3) var(--sp-3) var(--sp-2); }
.skeleton-line.short { width: 60%; }
.skeleton-price { height: 14px; width: 50%; margin: 0 var(--sp-3) var(--sp-3); }

/* EMPTY STATE */
.empty-state { text-align: center; padding: var(--sp-7) var(--sp-5); }
.empty-icon { font-size: 48px; margin-bottom: var(--sp-4); opacity: 0.4; }
.empty-title { font-size: 18px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--sp-2); }
.empty-desc { font-size: 13px; color: var(--text-secondary); max-width: 320px; margin: 0 auto var(--sp-5); line-height: 1.6; }
.empty-suggestions { display: flex; gap: var(--sp-2); justify-content: center; flex-wrap: wrap; }
.suggestion-pill {
  padding: var(--sp-2) var(--sp-3); background: var(--bg-surface-3); border: 1px solid var(--border-default);
  border-radius: var(--radius-xl); font-size: 12px; color: var(--interactive); cursor: pointer;
}

/* MOBILE NAV */
.mobile-nav {
  background: var(--bg-surface-2); border-bottom: 1px solid var(--border-subtle);
  padding: 0 var(--sp-3); height: 52px;
  display: flex; align-items: center; gap: var(--sp-3);
}
.mobile-logo { font-size: 14px; font-weight: 700; color: var(--accent-primary); }
.mobile-logo span { color: var(--text-primary); }
.mobile-search-icon { margin-left: auto; width: 36px; height: 36px; border-radius: var(--radius-md); background: var(--bg-surface-3); border: 1px solid var(--border-default); display: flex; align-items: center; justify-content: center; color: var(--text-secondary); font-size: 15px; }

/* MOBILE SEARCH SHEET */
.mobile-search-header {
  background: var(--bg-surface-2); padding: var(--sp-3) var(--sp-4);
  display: flex; align-items: center; gap: var(--sp-3);
  border-bottom: 1px solid var(--border-subtle);
}
.mobile-back { font-size: 14px; color: var(--interactive); cursor: pointer; }
.mobile-input {
  flex: 1; background: var(--bg-surface-3); border: 1px solid var(--interactive);
  border-radius: var(--radius-xl); height: 38px; padding: 0 var(--sp-3);
  font-size: 15px; color: var(--text-primary); font-family: inherit;
  box-shadow: 0 0 0 2px rgba(124,140,255,0.15);
}
.mobile-cancel { font-size: 13px; color: var(--text-secondary); cursor: pointer; white-space: nowrap; }

/* MOBILE RESULTS */
.mobile-results-grid {
  display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--sp-3); padding: var(--sp-4);
}

/* ALGOLIA BADGE */
.algolia-badge {
  display: inline-flex; align-items: center; gap: 4px;
  font-size: 10px; color: var(--text-tertiary); padding: 2px 6px;
  border: 1px solid var(--border-subtle); border-radius: var(--radius-sm);
}
.algolia-logo { font-weight: 700; color: #5468FF; }

/* DEGRADED BANNER */
.degraded-banner {
  background: rgba(239,83,80,0.08); border: 1px solid rgba(239,83,80,0.2);
  border-radius: var(--radius-md); padding: var(--sp-3) var(--sp-4);
  margin: var(--sp-4); font-size: 13px; color: #EF5350;
  display: flex; align-items: center; gap: var(--sp-3);
}

/* SECTION DIVIDER */
.section-divider {
  display: flex; align-items: center; gap: var(--sp-4);
  margin: var(--sp-6) 0 var(--sp-5);
}
.section-divider::before, .section-divider::after {
  content: ''; flex: 1; height: 1px; background: var(--border-subtle);
}
.section-divider-label { font-size: 12px; color: var(--text-tertiary); font-weight: 600; text-transform: uppercase; letter-spacing: 0.06em; white-space: nowrap; }

/* NOTES PANEL */
.notes { background: var(--bg-surface-2); border: 1px solid var(--border-subtle); border-radius: var(--radius-md); padding: var(--sp-5); margin-top: var(--sp-6); }
.notes h4 { font-size: 13px; font-weight: 600; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.06em; margin-bottom: var(--sp-4); }
.note-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: var(--sp-4); }
.note-item { }
.note-label { font-size: 11px; color: var(--text-tertiary); text-transform: uppercase; letter-spacing: 0.06em; font-weight: 600; margin-bottom: 4px; }
.note-text { font-size: 13px; color: var(--text-secondary); line-height: 1.5; }
.note-text code { font-family: monospace; font-size: 12px; background: var(--bg-surface-3); padding: 1px 5px; border-radius: 3px; color: var(--interactive); }

/* SPEC TABLE */
.spec-table { width: 100%; border-collapse: collapse; margin-top: var(--sp-4); font-size: 13px; }
.spec-table th { text-align: left; padding: var(--sp-2) var(--sp-3); font-size: 11px; font-weight: 600; color: var(--text-tertiary); text-transform: uppercase; letter-spacing: 0.06em; border-bottom: 1px solid var(--border-subtle); }
.spec-table td { padding: var(--sp-3); color: var(--text-secondary); border-bottom: 1px solid var(--border-subtle); vertical-align: top; }
.spec-table td:first-child { color: var(--text-primary); font-weight: 500; font-family: monospace; font-size: 12px; }
.spec-table tr:last-child td { border-bottom: none; }
.tag { display: inline-block; padding: 1px 7px; border-radius: var(--radius-xl); font-size: 11px; font-weight: 600; margin-right: 4px; margin-bottom: 2px; }
.tag.req { background: rgba(74,222,128,0.10); color: var(--positive); border: 1px solid rgba(74,222,128,0.2); }
.tag.opt { background: rgba(139,147,166,0.10); color: var(--text-secondary); border: 1px solid var(--border-default); }
</style>
</head>
<body>

<header class="showcase-header">
  <h1>SideDecked ‚Äî <span>Search & Autocomplete</span> Wireframe</h1>
  <p>Story 2-3 ¬∑ Algolia Search Index & Card Search with Autocomplete</p>
  <div class="story-meta">
    <span class="meta-chip">storefront/ + customer-backend/</span>
    <span class="meta-chip">react-instantsearch ¬∑ cmdk ¬∑ algoliasearch</span>
    <span class="meta-chip">2026-02-26</span>
    <span class="meta-chip warn">‚ö† NFR4: &lt;200ms search response</span>
  </div>
</header>

<nav class="tab-nav">
  <button class="tab-btn active" onclick="showPanel('nav-search')"><span class="num">1</span> Nav Search Bar</button>
  <button class="tab-btn" onclick="showPanel('autocomplete')"><span class="num">2</span> Autocomplete Open</button>
  <button class="tab-btn" onclick="showPanel('results')"><span class="num">3</span> Search Results Page</button>
  <button class="tab-btn" onclick="showPanel('no-results')"><span class="num">4</span> No Results / Did You Mean</button>
  <button class="tab-btn" onclick="showPanel('loading')"><span class="num">5</span> Loading States</button>
  <button class="tab-btn" onclick="showPanel('mobile')"><span class="num">6</span> Mobile Flows</button>
  <button class="tab-btn" onclick="showPanel('degraded')"><span class="num">7</span> Degraded / Error</button>
  <button class="tab-btn" onclick="showPanel('index-spec')"><span class="num">8</span> Algolia Index Schema</button>
</nav>

<main class="panels">

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       PANEL 1: NAV SEARCH BAR (default/collapsed state)
       ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="nav-search" class="panel active">
    <span class="panel-label">Screen 1</span>
    <h2 class="panel-title">Navigation Search Bar ‚Äî Default State</h2>
    <p class="panel-desc">
      The search trigger lives in the global nav across all storefront pages. Clicking it or pressing
      <kbd>‚åòK</kbd> opens the full-screen command palette overlay (cmdk). The trigger shows a placeholder
      and keyboard shortcut hint.
    </p>

    <div class="frame-row">
      <div class="frame-col wide">
        <div class="device-label">Desktop ‚Äî Nav bar (1280px)</div>
        <div class="screen">
          <div class="screen-chrome">
            <div class="chrome-dot"></div><div class="chrome-dot"></div><div class="chrome-dot"></div>
            <div class="chrome-url">sidedecked.com/cards</div>
          </div>
          <div class="nav-bar" style="position:relative;">
            <div class="nav-logo">Side<span>Decked</span></div>
            <div style="display:flex;gap:12px;font-size:13px;color:var(--text-secondary);">
              <span style="cursor:pointer;">Cards</span>
              <span style="cursor:pointer;">Decks</span>
              <span style="cursor:pointer;">Community</span>
            </div>
            <div class="search-trigger" style="cursor:text;" onclick="showPanel('autocomplete')">
              <span class="search-trigger-icon">üîç</span>
              <span class="search-trigger-text">Search cards, sets‚Ä¶</span>
              <span class="kbd-shortcut"><span>‚åò</span><span>K</span></span>
            </div>
            <div class="nav-actions">
              <div class="nav-btn">Sell</div>
              <div class="nav-avatar"></div>
            </div>
            <div class="annotation" style="top:62px;left:340px;">‚åòK triggers cmdk overlay</div>
            <div class="annotation accent" style="top:62px;right:60px;">Authenticated nav items</div>
          </div>
          <div style="padding:24px;text-align:center;color:var(--text-tertiary);font-size:13px;">
            ‚Ä¶ page content below nav ‚Ä¶
          </div>
        </div>
      </div>
    </div>

    <div class="notes">
      <h4>Implementation Notes ‚Äî Screen 1</h4>
      <div class="note-grid">
        <div class="note-item">
          <div class="note-label">Component</div>
          <div class="note-text">Replace existing <code>EnhancedSearchBar</code> with new <code>SearchCommandPalette</code> wrapper using <code>cmdk</code>. Keep nav trigger UI (pill shape, ‚åòK hint).</div>
        </div>
        <div class="note-item">
          <div class="note-label">Keyboard shortcut</div>
          <div class="note-text">Global <code>useEffect</code> listener for <code>‚åòK</code> / <code>Ctrl+K</code>. Opens cmdk dialog. <code>Escape</code> closes. Focus returns to trigger.</div>
        </div>
        <div class="note-item">
          <div class="note-label">Placement</div>
          <div class="note-text">Search trigger centered in nav between main links and auth actions. Max-width 420px. Shrinks on tablet to icon-only button.</div>
        </div>
        <div class="note-item">
          <div class="note-label">Accessibility</div>
          <div class="note-text"><code>role="combobox"</code> on trigger, <code>aria-expanded</code> reflects open state, <code>aria-label="Search cards, sets, and sellers"</code>.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       PANEL 2: AUTOCOMPLETE OPEN
       ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="autocomplete" class="panel">
    <span class="panel-label">Screen 2</span>
    <h2 class="panel-title">Autocomplete ‚Äî Command Palette Open</h2>
    <p class="panel-desc">
      After focusing or pressing ‚åòK, a full-screen overlay renders with the cmdk dialog centered.
      Typing 2+ characters triggers Algolia <code>searchSingleIndex</code>. Results show card thumbnail,
      name with match highlight, set context, game badge, and lowest price.
    </p>

    <div class="frame-row">
      <!-- State A: Recent searches (empty query) -->
      <div class="frame-col">
        <div class="device-label">State A ‚Äî Empty query (shows recent searches)</div>
        <div class="screen" style="min-height:460px;position:relative;">
          <div class="nav-bar">
            <div class="nav-logo">Side<span>Decked</span></div>
            <div class="search-trigger" style="border-color:var(--interactive);box-shadow:0 0 0 2px rgba(124,140,255,0.12);">
              <span class="search-trigger-icon">üîç</span>
              <span class="search-trigger-text" style="color:var(--text-primary);">|</span>
              <span class="kbd-shortcut">esc</span>
            </div>
            <div class="nav-actions"><div class="nav-avatar"></div></div>
          </div>
          <div class="cmdk-overlay">
            <div class="cmdk-dialog">
              <div class="cmdk-input-row">
                <span class="cmdk-input-icon">üîç</span>
                <input class="cmdk-input" placeholder="Search cards, sets, sellers‚Ä¶" value="" readonly />
                <span class="cmdk-esc">esc</span>
              </div>
              <div class="suggestions-header">
                Recent Searches
                <span class="suggestions-clear">Clear</span>
              </div>
              <div class="suggestion-item">
                <div class="suggestion-type-icon recent">üïê</div>
                <div class="suggestion-body">
                  <div class="suggestion-name">Charizard ex</div>
                  <div class="suggestion-meta"><span class="suggestion-set">Recent search</span></div>
                </div>
              </div>
              <div class="suggestion-item">
                <div class="suggestion-type-icon recent">üïê</div>
                <div class="suggestion-body">
                  <div class="suggestion-name">Black Lotus</div>
                  <div class="suggestion-meta"><span class="suggestion-set">Recent search</span></div>
                </div>
              </div>
              <div class="suggestion-item">
                <div class="suggestion-type-icon recent">üïê</div>
                <div class="suggestion-body">
                  <div class="suggestion-name">Blue-Eyes White Dragon</div>
                  <div class="suggestion-meta"><span class="suggestion-set">Recent search</span></div>
                </div>
              </div>
              <div class="suggestions-footer">
                <span><span class="kbd">‚Üë‚Üì</span> Navigate</span>
                <span><span class="kbd">‚Üµ</span> Select</span>
                <span><span class="kbd">esc</span> Close</span>
              </div>
            </div>
          </div>
          <div class="annotation" style="bottom:100px;right:16px;">Recent from localStorage</div>
        </div>
      </div>

      <!-- State B: Active query with card suggestions -->
      <div class="frame-col">
        <div class="device-label">State B ‚Äî Query "chara" ‚Üí Algolia suggestions</div>
        <div class="screen" style="min-height:560px;position:relative;">
          <div class="nav-bar">
            <div class="nav-logo">Side<span>Decked</span></div>
            <div class="search-trigger" style="border-color:var(--interactive);box-shadow:0 0 0 2px rgba(124,140,255,0.12);">
              <span class="search-trigger-icon">üîç</span>
              <span class="search-trigger-text" style="color:var(--text-primary);">chara|</span>
            </div>
            <div class="nav-actions"><div class="nav-avatar"></div></div>
          </div>
          <div class="cmdk-overlay">
            <div class="cmdk-dialog">
              <div class="cmdk-input-row">
                <span class="cmdk-input-icon">üîç</span>
                <input class="cmdk-input" value="chara" readonly />
                <span class="cmdk-esc">esc</span>
              </div>

              <!-- Card suggestions -->
              <div class="suggestions-header">Cards</div>

              <div class="suggestion-item active">
                <div class="suggestion-thumb"><span class="thumb-placeholder">üÉè</span></div>
                <div class="suggestion-body">
                  <div class="suggestion-name"><mark>Chara</mark>zard ex (SV Black Star Promos)</div>
                  <div class="suggestion-meta">
                    <span class="suggestion-set">SV Promos ¬∑ SVP ¬∑ #071</span>
                    <span class="game-badge pokemon">Pok√©mon</span>
                  </div>
                </div>
                <div class="suggestion-price">$89.99</div>
              </div>

              <div class="suggestion-item">
                <div class="suggestion-thumb"><span class="thumb-placeholder">üÉè</span></div>
                <div class="suggestion-body">
                  <div class="suggestion-name"><mark>Chara</mark>zard ex (Obsidian Flames)</div>
                  <div class="suggestion-meta">
                    <span class="suggestion-set">Obsidian Flames ¬∑ OBF ¬∑ #125</span>
                    <span class="game-badge pokemon">Pok√©mon</span>
                  </div>
                </div>
                <div class="suggestion-price">$44.50</div>
              </div>

              <div class="suggestion-item">
                <div class="suggestion-thumb"><span class="thumb-placeholder">üÉè</span></div>
                <div class="suggestion-body">
                  <div class="suggestion-name"><mark>Chara</mark>zard V (Champion's Path)</div>
                  <div class="suggestion-meta">
                    <span class="suggestion-set">Champion's Path ¬∑ CPA ¬∑ #021</span>
                    <span class="game-badge pokemon">Pok√©mon</span>
                  </div>
                </div>
                <div class="suggestion-price">$22.00</div>
              </div>

              <!-- Set suggestion -->
              <div class="suggestions-header" style="margin-top:4px;">Sets</div>
              <div class="suggestion-item">
                <div class="suggestion-type-icon set">üì¶</div>
                <div class="suggestion-body">
                  <div class="suggestion-name">Chilling Reign</div>
                  <div class="suggestion-meta">
                    <span class="suggestion-set">217 cards</span>
                    <span class="game-badge pokemon">Pok√©mon</span>
                  </div>
                </div>
              </div>

              <div class="suggestions-footer">
                <span><span class="kbd">‚Üµ</span> Open card</span>
                <span><span class="kbd">‚Üµ</span> View all results (on query)</span>
                <span style="margin-left:auto;"><span class="algolia-badge"><span class="algolia-logo">A</span> Algolia</span></span>
              </div>
            </div>
          </div>
          <div class="annotation" style="bottom:52px;right:16px;">200ms debounce on input</div>
          <div class="annotation accent" style="bottom:88px;right:16px;">Match highlight via Algolia snippets</div>
        </div>
      </div>
    </div>

    <div class="notes">
      <h4>Implementation Notes ‚Äî Autocomplete</h4>
      <div class="note-grid">
        <div class="note-item">
          <div class="note-label">Library</div>
          <div class="note-text"><code>cmdk</code> for dialog + keyboard nav. <code>react-instantsearch</code> <code>useSearchBox</code> + <code>useHits</code> hooks for Algolia results inside the dialog.</div>
        </div>
        <div class="note-item">
          <div class="note-label">Algolia call</div>
          <div class="note-text">Client-side using <code>NEXT_PUBLIC_ALGOLIA_APP_ID</code> + <code>NEXT_PUBLIC_ALGOLIA_SEARCH_KEY</code> (read-only). <code>hitsPerPage: 5</code>, <code>attributesToHighlight: ['name']</code>.</div>
        </div>
        <div class="note-item">
          <div class="note-label">Match highlight</div>
          <div class="note-text">Use Algolia <code>_highlightResult</code> attribute to render matched chars in <code>--accent-primary</code> gold. No custom highlighting logic.</div>
        </div>
        <div class="note-item">
          <div class="note-label">Thumbnail</div>
          <div class="note-text">36√ó50px card thumb from <code>image_url</code> index attribute (MinIO CDN). Show placeholder icon on load/error.</div>
        </div>
        <div class="note-item">
          <div class="note-label">Navigation</div>
          <div class="note-text">Card suggestion ‚Üí navigate to <code>/cards/{id}</code>. Set suggestion ‚Üí navigate to <code>/cards?set={set_code}</code>. Enter/‚åò+Enter on query ‚Üí navigate to <code>/search?q={query}</code>.</div>
        </div>
        <div class="note-item">
          <div class="note-label">Algolia attribution</div>
          <div class="note-text">Show small "Search by Algolia" badge in footer per Algolia free-tier requirements.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       PANEL 3: SEARCH RESULTS PAGE
       ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="results" class="panel">
    <span class="panel-label">Screen 3</span>
    <h2 class="panel-title">Search Results Page ‚Äî /search?q=charizard</h2>
    <p class="panel-desc">
      The <code>/search</code> page uses <code>react-instantsearch-nextjs</code> for SSR-compatible Algolia search.
      Results display via the existing <code>CardDisplay</code> component as Algolia hit renderer.
      Grid is responsive: 2 cols mobile ‚Üí 3 tablet ‚Üí 4-5 desktop.
    </p>

    <div class="frame-row">
      <div class="frame-col wide">
        <div class="device-label">Desktop ‚Äî Results page (full width)</div>
        <div class="screen">
          <div class="nav-bar">
            <div class="nav-logo">Side<span>Decked</span></div>
            <div class="results-search-box" style="flex:1;max-width:420px;">
              <span style="color:var(--text-tertiary);font-size:14px;">üîç</span>
              <span class="results-search-query">charizard</span>
              <span class="results-search-clear">‚úï</span>
            </div>
            <div class="nav-actions"><div class="nav-avatar"></div></div>
          </div>

          <div class="results-header">
            <div class="results-meta-row">
              <span class="results-count"><strong>847</strong> results for "charizard"</span>
              <div style="margin-left:auto;display:flex;align-items:center;gap:12px;">
                <select class="sort-select">
                  <option>Sort: Relevance</option>
                  <option>Price: Low ‚Üí High</option>
                  <option>Price: High ‚Üí Low</option>
                </select>
                <span class="algolia-badge"><span class="algolia-logo">A</span> Algolia</span>
              </div>
            </div>
          </div>

          <div class="results-content">
            <div class="results-main">
              <div class="results-grid">
                <!-- Hit 1 -->
                <div class="card-item">
                  <div class="card-img-wrap"><div class="card-img-placeholder">üÉè</div><div class="card-rarity-pip rarity-rare"></div></div>
                  <div class="card-info">
                    <div class="card-name">Charizard ex</div>
                    <div class="card-set">Obsidian Flames ¬∑ OBF</div>
                    <div class="card-price-row">
                      <span class="card-price">$44.50</span>
                      <span class="card-sellers">3 sellers</span>
                    </div>
                    <div class="card-game-badge"><span class="game-badge pokemon">Pok√©mon</span></div>
                  </div>
                </div>
                <!-- Hit 2 -->
                <div class="card-item">
                  <div class="card-img-wrap"><div class="card-img-placeholder">üÉè</div><div class="card-rarity-pip rarity-mythic"></div></div>
                  <div class="card-info">
                    <div class="card-name">Charizard ex (SV Promo)</div>
                    <div class="card-set">SV Promos ¬∑ SVP #071</div>
                    <div class="card-price-row">
                      <span class="card-price">$89.99</span>
                      <span class="card-sellers">1 seller</span>
                    </div>
                    <div class="card-game-badge"><span class="game-badge pokemon">Pok√©mon</span></div>
                  </div>
                </div>
                <!-- Hit 3 -->
                <div class="card-item">
                  <div class="card-img-wrap"><div class="card-img-placeholder">üÉè</div><div class="card-rarity-pip rarity-uncommon"></div></div>
                  <div class="card-info">
                    <div class="card-name">Charizard V</div>
                    <div class="card-set">Champion's Path ¬∑ CPA</div>
                    <div class="card-price-row">
                      <span class="card-price">$22.00</span>
                      <span class="card-sellers">5 sellers</span>
                    </div>
                    <div class="card-game-badge"><span class="game-badge pokemon">Pok√©mon</span></div>
                  </div>
                </div>
                <!-- Hit 4 -->
                <div class="card-item">
                  <div class="card-img-wrap"><div class="card-img-placeholder">üÉè</div><div class="card-rarity-pip rarity-rare"></div></div>
                  <div class="card-info">
                    <div class="card-name">Charizard VMAX</div>
                    <div class="card-set">Darkness Ablaze ¬∑ DAA</div>
                    <div class="card-price-row">
                      <span class="card-price">$31.00</span>
                      <span class="card-sellers">7 sellers</span>
                    </div>
                    <div class="card-game-badge"><span class="game-badge pokemon">Pok√©mon</span></div>
                  </div>
                </div>
                <!-- Hit 5 -->
                <div class="card-item">
                  <div class="card-img-wrap"><div class="card-img-placeholder">üÉè</div><div class="card-rarity-pip rarity-common"></div></div>
                  <div class="card-info">
                    <div class="card-name">Charizard (Base Set)</div>
                    <div class="card-set">Base Set ¬∑ BS1 ¬∑ #4</div>
                    <div class="card-price-row">
                      <span class="card-price">$380.00</span>
                      <span class="card-sellers">2 sellers</span>
                    </div>
                    <div class="card-game-badge"><span class="game-badge pokemon">Pok√©mon</span></div>
                  </div>
                </div>
                <!-- Hit 6 -->
                <div class="card-item">
                  <div class="card-img-wrap"><div class="card-img-placeholder">üÉè</div><div class="card-rarity-pip rarity-rare"></div></div>
                  <div class="card-info">
                    <div class="card-name">Charmander</div>
                    <div class="card-set">Scarlet & Violet ¬∑ SVI</div>
                    <div class="card-price-row">
                      <span class="card-price">$1.20</span>
                      <span class="card-sellers">12 sellers</span>
                    </div>
                    <div class="card-game-badge"><span class="game-badge pokemon">Pok√©mon</span></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="notes">
      <h4>Implementation Notes ‚Äî Search Results Page</h4>
      <div class="note-grid">
        <div class="note-item">
          <div class="note-label">SSR strategy</div>
          <div class="note-text">Use <code>react-instantsearch-nextjs</code> <code>&lt;InstantSearchNext&gt;</code> with server-side initial state. Search query from <code>searchParams.q</code>. Results hydrate client-side on interaction.</div>
        </div>
        <div class="note-item">
          <div class="note-label">Hit renderer</div>
          <div class="note-text">Use existing <code>CardDisplay</code> component (from <code>src/components/tcg/</code>) as the <code>hitComponent</code> for <code>&lt;Hits&gt;</code>. Map Algolia hit attributes to CardDisplay props.</div>
        </div>
        <div class="note-item">
          <div class="note-label">PriceTag</div>
          <div class="note-text"><code>PriceTag</code> receives <code>lowest_price</code> (number | null) + <code>seller_count</code> (number) from Algolia record. Renders "$44.50 ¬∑ 3 sellers". When <code>lowest_price === null</code> or <code>seller_count === 0</code>: render "No listings" in <code>--text-tertiary</code>.</div>
        </div>
        <div class="note-item">
          <div class="note-label">No filter panel (2-3)</div>
          <div class="note-text">Faceted filters are story 2-4. This page has sort dropdown only. Filter panel space reserved for 2-4 (left sidebar slot).</div>
        </div>
        <div class="note-item">
          <div class="note-label">Pagination</div>
          <div class="note-text">Use Algolia <code>&lt;Pagination&gt;</code> from <code>react-instantsearch</code>. 20 hits per page. URL-reflected: <code>/search?q=charizard&page=2</code>.</div>
        </div>
        <div class="note-item">
          <div class="note-label">Sort replicas</div>
          <div class="note-text">Sort dropdown in 2-3 should default to "Relevance" only. Price sorting requires Algolia replica indices ‚Äî deferred to 2-4. Show dropdown but disable non-relevance options with tooltip "Coming soon".</div>
        </div>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       PANEL 4: NO RESULTS / DID YOU MEAN
       ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="no-results" class="panel">
    <span class="panel-label">Screen 4</span>
    <h2 class="panel-title">No Results + "Did You Mean?" States</h2>
    <p class="panel-desc">
      When zero results are returned and Algolia detects a likely typo, surface the "Did you mean?" suggestion
      using Algolia's built-in typo correction. When no correction is available, show curated fallback suggestions.
    </p>

    <div class="frame-row">
      <!-- State A: Did you mean -->
      <div class="frame-col">
        <div class="device-label">State A ‚Äî Typo detected ("chariazrd")</div>
        <div class="screen">
          <div class="nav-bar">
            <div class="nav-logo">Side<span>Decked</span></div>
            <div class="results-search-box" style="flex:1;max-width:420px;">
              <span style="color:var(--text-tertiary);font-size:14px;">üîç</span>
              <span class="results-search-query">chariazrd</span>
              <span class="results-search-clear">‚úï</span>
            </div>
            <div class="nav-actions"><div class="nav-avatar"></div></div>
          </div>
          <div style="padding:16px;">
            <div class="did-you-mean">
              üî§ No results for "chariazrd" ‚Äî did you mean <a onclick="showPanel('results')">charizard</a>?
            </div>
            <div class="empty-state">
              <div class="empty-icon">üîç</div>
              <div class="empty-title">No cards found for "chariazrd"</div>
              <div class="empty-desc">
                We couldn't find any cards matching that spelling. Try the suggestion above,
                or browse by game below.
              </div>
              <div class="empty-suggestions">
                <span class="suggestion-pill">üü£ MTG</span>
                <span class="suggestion-pill">üü° Pok√©mon</span>
                <span class="suggestion-pill">üîµ Yu-Gi-Oh!</span>
                <span class="suggestion-pill">üü¢ One Piece</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- State B: Genuine no results -->
      <div class="frame-col">
        <div class="device-label">State B ‚Äî No results, no correction ("xyz123card")</div>
        <div class="screen">
          <div class="nav-bar">
            <div class="nav-logo">Side<span>Decked</span></div>
            <div class="results-search-box" style="flex:1;max-width:420px;">
              <span style="color:var(--text-tertiary);font-size:14px;">üîç</span>
              <span class="results-search-query">xyz123card</span>
              <span class="results-search-clear">‚úï</span>
            </div>
            <div class="nav-actions"><div class="nav-avatar"></div></div>
          </div>
          <div style="padding:16px;">
            <div class="empty-state">
              <div class="empty-icon">üÉè</div>
              <div class="empty-title">No cards found</div>
              <div class="empty-desc">
                We searched across all four games and couldn't find "xyz123card".
                This card may not be in our catalog yet, or try a different spelling.
              </div>
              <div class="empty-suggestions">
                <span class="suggestion-pill">Browse all cards ‚Üí</span>
                <span class="suggestion-pill">Try "Black Lotus"</span>
                <span class="suggestion-pill">Try "Pikachu"</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="notes">
      <h4>Implementation Notes ‚Äî No Results</h4>
      <div class="note-grid">
        <div class="note-item">
          <div class="note-label">Did You Mean</div>
          <div class="note-text">Use Algolia's <code>typoTolerance: true</code> (default). When <code>hits.length === 0</code> and <code>queryAfterRemoval</code> differs, show "Did you mean [corrected]?" banner.</div>
        </div>
        <div class="note-item">
          <div class="note-label">Algolia component</div>
          <div class="note-text">Use <code>&lt;NoResults&gt;</code> with <code>QueryRuleCustomData</code> or custom render from <code>useInstantSearch()</code> state. Check <code>results.nbHits === 0</code>.</div>
        </div>
        <div class="note-item">
          <div class="note-label">Microcopy</div>
          <div class="note-text">Tone: friendly and helpful, not clinical. "No cards found" not "0 results returned". "Try a different spelling" not "Query returned no documents".</div>
        </div>
        <div class="note-item">
          <div class="note-label">Accessibility</div>
          <div class="note-text">"Did you mean?" banner has <code>role="alert"</code> so screen readers announce the suggestion automatically.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       PANEL 5: LOADING STATES
       ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="loading" class="panel">
    <span class="panel-label">Screen 5</span>
    <h2 class="panel-title">Loading & Skeleton States</h2>
    <p class="panel-desc">
      Skeleton screens replace spinners for search results. The grid layout is preserved during
      loading so layout shift is minimal. Autocomplete shows a spinner inline on the search input
      during the 200ms debounce + Algolia RTT.
    </p>

    <div class="frame-row">
      <div class="frame-col wide">
        <div class="device-label">Search results ‚Äî loading skeleton (first load / query change)</div>
        <div class="screen">
          <div class="nav-bar">
            <div class="nav-logo">Side<span>Decked</span></div>
            <div class="results-search-box" style="flex:1;max-width:420px;">
              <span style="color:var(--text-tertiary);font-size:14px;">üîç</span>
              <span class="results-search-query">charizard</span>
              <div style="width:14px;height:14px;border:2px solid rgba(124,140,255,0.3);border-top-color:var(--interactive);border-radius:50%;animation:spin 0.8s linear infinite;margin-left:auto;"></div>
            </div>
            <div class="nav-actions"><div class="nav-avatar"></div></div>
          </div>
          <style>@keyframes spin{to{transform:rotate(360deg)}}</style>
          <div style="padding:16px 20px 8px;">
            <div class="skeleton" style="height:14px;width:180px;border-radius:6px;"></div>
          </div>
          <div style="padding:12px 20px;display:grid;grid-template-columns:repeat(5,1fr);gap:12px;">
            <div class="skeleton-card"><div class="skeleton skeleton-img"></div><div class="skeleton skeleton-line"></div><div class="skeleton skeleton-line short"></div><div class="skeleton skeleton-price"></div></div>
            <div class="skeleton-card"><div class="skeleton skeleton-img"></div><div class="skeleton skeleton-line"></div><div class="skeleton skeleton-line short"></div><div class="skeleton skeleton-price"></div></div>
            <div class="skeleton-card"><div class="skeleton skeleton-img"></div><div class="skeleton skeleton-line"></div><div class="skeleton skeleton-line short"></div><div class="skeleton skeleton-price"></div></div>
            <div class="skeleton-card"><div class="skeleton skeleton-img"></div><div class="skeleton skeleton-line"></div><div class="skeleton skeleton-line short"></div><div class="skeleton skeleton-price"></div></div>
            <div class="skeleton-card"><div class="skeleton skeleton-img"></div><div class="skeleton skeleton-line"></div><div class="skeleton skeleton-line short"></div><div class="skeleton skeleton-price"></div></div>
          </div>
        </div>
      </div>
    </div>

    <div class="notes">
      <h4>Implementation Notes ‚Äî Loading</h4>
      <div class="note-grid">
        <div class="note-item">
          <div class="note-label">Skeleton component</div>
          <div class="note-text">Create <code>SearchResultsSkeleton</code> that renders same grid as results. Show when <code>useInstantSearch().status === 'loading'</code>. Avoids layout shift on result arrival.</div>
        </div>
        <div class="note-item">
          <div class="note-label">Autocomplete spinner</div>
          <div class="note-text">Show spinner in cmdk input right side when <code>useSearchBox().isSearchStalled</code> is true (Algolia RTT > 200ms threshold).</div>
        </div>
        <div class="note-item">
          <div class="note-label">prefers-reduced-motion</div>
          <div class="note-text">Skeleton shimmer animation must be disabled when <code>prefers-reduced-motion: reduce</code>. Use static gray instead.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       PANEL 6: MOBILE FLOWS
       ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="mobile" class="panel">
    <span class="panel-label">Screen 6</span>
    <h2 class="panel-title">Mobile Flows (375px)</h2>
    <p class="panel-desc">
      On mobile, the nav search trigger becomes a search icon button. Tapping it slides in a full-screen
      search view. Results use a 2-column card grid. Bottom sheet card preview (on card tap) is defined
      in story 2-5 ‚Äî not in scope here.
    </p>

    <div class="frame-row">
      <!-- Mobile nav -->
      <div class="frame-col narrow">
        <div class="device-label">Mobile nav (search icon)</div>
        <div class="screen" style="max-width:375px;">
          <div class="mobile-nav">
            <div class="mobile-logo">Side<span>Decked</span></div>
            <div style="display:flex;align-items:center;gap:8px;margin-left:auto;">
              <div class="mobile-search-icon">üîç</div>
              <div class="nav-avatar"></div>
            </div>
          </div>
          <div style="padding:16px;text-align:center;color:var(--text-tertiary);font-size:13px;">‚Ä¶ page content ‚Ä¶</div>
        </div>
      </div>

      <!-- Mobile search open -->
      <div class="frame-col narrow">
        <div class="device-label">Mobile search open (full screen)</div>
        <div class="screen" style="max-width:375px;">
          <div class="mobile-search-header">
            <span class="mobile-back">‚Üê Back</span>
            <input class="mobile-input" placeholder="Search cards, sets‚Ä¶" value="chara" readonly />
            <span class="mobile-cancel">Cancel</span>
          </div>
          <div class="suggestion-item active">
            <div class="suggestion-thumb"><span class="thumb-placeholder">üÉè</span></div>
            <div class="suggestion-body">
              <div class="suggestion-name"><mark>Chara</mark>zard ex</div>
              <div class="suggestion-meta">
                <span class="suggestion-set">Obsidian Flames</span>
                <span class="game-badge pokemon">Pkm</span>
              </div>
            </div>
            <div class="suggestion-price">$44.50</div>
          </div>
          <div class="suggestion-item">
            <div class="suggestion-thumb"><span class="thumb-placeholder">üÉè</span></div>
            <div class="suggestion-body">
              <div class="suggestion-name"><mark>Chara</mark>zard V</div>
              <div class="suggestion-meta">
                <span class="suggestion-set">Champion's Path</span>
                <span class="game-badge pokemon">Pkm</span>
              </div>
            </div>
            <div class="suggestion-price">$22.00</div>
          </div>
          <div class="suggestion-item">
            <div class="suggestion-thumb"><span class="thumb-placeholder">üÉè</span></div>
            <div class="suggestion-body">
              <div class="suggestion-name"><mark>Chara</mark>zard Base Set</div>
              <div class="suggestion-meta">
                <span class="suggestion-set">Base Set ¬∑ #4</span>
                <span class="game-badge pokemon">Pkm</span>
              </div>
            </div>
            <div class="suggestion-price">$380</div>
          </div>
          <div style="padding:12px 16px;border-top:1px solid var(--border-subtle);">
            <div style="text-align:center;font-size:13px;color:var(--interactive);cursor:pointer;">
              View all results for "chara" ‚Üí
            </div>
          </div>
        </div>
      </div>

      <!-- Mobile results grid -->
      <div class="frame-col narrow">
        <div class="device-label">Mobile results (2-col grid)</div>
        <div class="screen" style="max-width:375px;">
          <div class="mobile-nav">
            <div class="mobile-logo">Side<span>Decked</span></div>
            <div class="results-search-box" style="flex:1;margin:0 8px;height:34px;max-width:none;">
              <span style="color:var(--text-tertiary);font-size:13px;">üîç</span>
              <span style="font-size:13px;color:var(--text-primary);">charizard</span>
              <span class="results-search-clear" style="margin-left:auto;">‚úï</span>
            </div>
          </div>
          <div style="padding:8px 12px 4px;font-size:12px;color:var(--text-secondary);">
            <strong style="color:var(--text-primary);">847</strong> results
          </div>
          <div class="mobile-results-grid">
            <div class="card-item">
              <div class="card-img-wrap"><div class="card-img-placeholder" style="font-size:24px;">üÉè</div><div class="card-rarity-pip rarity-rare"></div></div>
              <div class="card-info">
                <div class="card-name">Charizard ex</div>
                <div class="card-set">Obsidian Flames</div>
                <div class="card-price-row"><span class="card-price">$44.50</span><span class="card-sellers">3</span></div>
                <div class="card-game-badge"><span class="game-badge pokemon">Pkm</span></div>
              </div>
            </div>
            <div class="card-item">
              <div class="card-img-wrap"><div class="card-img-placeholder" style="font-size:24px;">üÉè</div><div class="card-rarity-pip rarity-mythic"></div></div>
              <div class="card-info">
                <div class="card-name">Charizard ex SVP</div>
                <div class="card-set">SV Promos</div>
                <div class="card-price-row"><span class="card-price">$89.99</span><span class="card-sellers">1</span></div>
                <div class="card-game-badge"><span class="game-badge pokemon">Pkm</span></div>
              </div>
            </div>
            <div class="card-item">
              <div class="card-img-wrap"><div class="card-img-placeholder" style="font-size:24px;">üÉè</div><div class="card-rarity-pip rarity-uncommon"></div></div>
              <div class="card-info">
                <div class="card-name">Charizard V</div>
                <div class="card-set">Champion's Path</div>
                <div class="card-price-row"><span class="card-price">$22.00</span><span class="card-sellers">5</span></div>
                <div class="card-game-badge"><span class="game-badge pokemon">Pkm</span></div>
              </div>
            </div>
            <div class="card-item">
              <div class="card-img-wrap"><div class="card-img-placeholder" style="font-size:24px;">üÉè</div><div class="card-rarity-pip rarity-rare"></div></div>
              <div class="card-info">
                <div class="card-name">Charizard VMAX</div>
                <div class="card-set">Darkness Ablaze</div>
                <div class="card-price-row"><span class="card-price">$31.00</span><span class="card-sellers">7</span></div>
                <div class="card-game-badge"><span class="game-badge pokemon">Pkm</span></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="notes">
      <h4>Implementation Notes ‚Äî Mobile</h4>
      <div class="note-grid">
        <div class="note-item">
          <div class="note-label">Nav trigger (mobile)</div>
          <div class="note-text">Below <code>md</code> breakpoint: nav search pill collapses to 36√ó36 icon button. Icon tap pushes to <code>/search</code> route with focus on input.</div>
        </div>
        <div class="note-item">
          <div class="note-label">Full-screen search</div>
          <div class="note-text">On mobile, <code>/search</code> renders full-screen without the cmdk overlay. Input auto-focuses. "Cancel" navigates back. Uses same Algolia <code>useSearchBox</code> hook.</div>
        </div>
        <div class="note-item">
          <div class="note-label">Touch targets</div>
          <div class="note-text">Suggestion items min-height 48px. Card grid items ~160px wide. Game badge tap area ‚â• 32px. All interactive elements ‚â• 44px touch target.</div>
        </div>
        <div class="note-item">
          <div class="note-label">Virtual keyboard</div>
          <div class="note-text">Input <code>inputMode="search"</code>, <code>enterKeyHint="search"</code> for correct mobile keyboard. iOS shows search key, Android shows done/go.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       PANEL 7: DEGRADED / ERROR
       ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="degraded" class="panel">
    <span class="panel-label">Screen 7</span>
    <h2 class="panel-title">Degraded Mode ‚Äî Algolia Unavailable</h2>
    <p class="panel-desc">
      Per NFR47, Algolia integration must degrade gracefully. When the Algolia client fails to respond,
      show a non-blocking inline notice. The search bar becomes visually disabled. No fallback DB search.
    </p>

    <div class="frame-row">
      <div class="frame-col wide">
        <div class="device-label">Algolia unavailable ‚Äî search disabled state</div>
        <div class="screen">
          <div class="nav-bar">
            <div class="nav-logo">Side<span>Decked</span></div>
            <div class="search-trigger" style="opacity:0.5;cursor:not-allowed;border-color:rgba(239,83,80,0.3);">
              <span class="search-trigger-icon">üîç</span>
              <span class="search-trigger-text">Search temporarily unavailable</span>
              <span style="font-size:11px;color:#EF5350;">‚óè</span>
            </div>
            <div class="nav-actions"><div class="nav-avatar"></div></div>
          </div>
          <div class="degraded-banner" style="margin:16px;">
            <span>‚ö†Ô∏è</span>
            <span>Search is temporarily unavailable ‚Äî we're looking into it. <a style="color:#EF5350;text-decoration:underline;cursor:pointer;">Browse all cards instead ‚Üí</a></span>
          </div>
          <div style="padding:16px;text-align:center;color:var(--text-tertiary);font-size:13px;">‚Ä¶ page content still accessible ‚Ä¶</div>
        </div>
      </div>
    </div>

    <div class="notes">
      <h4>Implementation Notes ‚Äî Degraded</h4>
      <div class="note-grid">
        <div class="note-item">
          <div class="note-label">Trigger</div>
          <div class="note-text">Catch Algolia client init error (from <code>ALLOW_DEGRADED_START</code> config) or network failure. Set <code>searchUnavailable</code> state in context provider.</div>
        </div>
        <div class="note-item">
          <div class="note-label">No fallback</div>
          <div class="note-text">Do NOT fall back to customer-backend text search. The scope explicitly excludes this. "Browse all cards" link goes to <code>/cards</code> which shows the full catalog.</div>
        </div>
        <div class="note-item">
          <div class="note-label">User tone</div>
          <div class="note-text">"Search temporarily unavailable" ‚Äî never "Error 503" or "Algolia connection failed". Warm, honest, brief.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       PANEL 8: ALGOLIA INDEX SCHEMA
       ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="index-spec" class="panel">
    <span class="panel-label">Reference</span>
    <h2 class="panel-title">Algolia Index Schema ‚Äî sidedecked_cards</h2>
    <p class="panel-desc">
      The Algolia record schema defines what fields are searchable, filterable (facetable), retrievable,
      and stored. This drives both the indexing service (customer-backend) and the storefront search configuration.
    </p>

    <table class="spec-table">
      <thead>
        <tr>
          <th>Field</th>
          <th>Type</th>
          <th>Algolia Config</th>
          <th>Source</th>
          <th>AC / Notes</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>objectID</td><td>string</td><td>Required ID</td><td>Card.id (UUID)</td><td>Primary key</td></tr>
        <tr><td>name</td><td>string</td><td>Searchable (rank 1), Snippet</td><td>Card.name</td><td>AC2: autocomplete match + highlight</td></tr>
        <tr><td>game</td><td>string</td><td>Searchable (rank 2), Facet, Filter</td><td>Game.code (MTG/POKEMON/YUGIOH/OPTCG)</td><td>AC1: game facet ¬∑ AC3: game badge</td></tr>
        <tr><td>set_name</td><td>string</td><td>Searchable (rank 3), Snippet</td><td>CardSet.name</td><td>AC2: set context in autocomplete</td></tr>
        <tr><td>set_code</td><td>string</td><td>Filter</td><td>CardSet.code</td><td>Set page navigation</td></tr>
        <tr><td>rarity</td><td>string</td><td>Facet, Filter</td><td>Card.rarity</td><td>AC1: rarity facet</td></tr>
        <tr><td>format_legality</td><td>string[]</td><td>Facet, Filter</td><td>FormatLegality[] joined</td><td>AC1: format legality facet</td></tr>
        <tr><td>image_url</td><td>string</td><td>Retrieve only</td><td>Card.imageUrl (MinIO CDN)</td><td>Autocomplete thumbnail + card grid</td></tr>
        <tr><td>lowest_price</td><td>number | null</td><td>Retrieve only, Numeric filter</td><td>Computed from active listings</td><td>AC4: PriceTag lowest price</td></tr>
        <tr><td>seller_count</td><td>number</td><td>Retrieve only</td><td>Count of active listings</td><td>AC4: "N sellers" in PriceTag</td></tr>
        <tr><td>artist</td><td>string</td><td>Searchable (rank 4)</td><td>Card.artist</td><td>Power user artist search</td></tr>
        <tr><td>collector_number</td><td>string</td><td>Filter</td><td>Card.collectorNumber</td><td>Exact printing lookup</td></tr>
        <tr><td>language</td><td>string</td><td>Facet, Filter</td><td>Card.language</td><td>AC1: language facet</td></tr>
        <tr><td>updated_at</td><td>timestamp</td><td>Retrieve only</td><td>Card.updatedAt</td><td>Delta sync: index only changed records</td></tr>
      </tbody>
    </table>

    <div class="section-divider"><span class="section-divider-label">Index Configuration</span></div>

    <table class="spec-table">
      <thead><tr><th>Setting</th><th>Value</th><th>Reason</th></tr></thead>
      <tbody>
        <tr><td>searchableAttributes</td><td>name, game, set_name, artist, collector_number</td><td>Ordered by relevance weight</td></tr>
        <tr><td>attributesForFaceting</td><td>game, rarity, format_legality, language, set_code</td><td>Story 2-3 facets (2-4 will add condition, price)</td></tr>
        <tr><td>typoTolerance</td><td>true (default)</td><td>AC5: "Did you mean?" fuzzy match</td></tr>
        <tr><td>minWordSizefor1Typo</td><td>4 (default)</td><td>Avoid false positives on short names</td></tr>
        <tr><td>hitsPerPage</td><td>20 (results) / 5 (autocomplete)</td><td>Grid layout + performance</td></tr>
        <tr><td>unretrievableAttributes</td><td>(none for MVP)</td><td>All stored attributes safe to expose (no PII)</td></tr>
        <tr><td>replicas</td><td>sidedecked_cards_price_asc, _price_desc</td><td>Created but used in story 2-4</td></tr>
      </tbody>
    </table>

    <div class="notes" style="margin-top:24px;">
      <h4>Indexing Strategy</h4>
      <div class="note-grid">
        <div class="note-item">
          <div class="note-label">Initial full sync</div>
          <div class="note-text">Admin endpoint <code>POST /api/admin/search/reindex</code> triggers full batch index of all cards. Batches of 1,000 records via Algolia batch API.</div>
        </div>
        <div class="note-item">
          <div class="note-label">Incremental sync</div>
          <div class="note-text">On card create/update in customer-backend, push to <code>search-indexing</code> Bull queue. Worker processes queue and calls <code>algolia.saveObject()</code>.</div>
        </div>
        <div class="note-item">
          <div class="note-label">Price updates</div>
          <div class="note-text"><code>lowest_price</code> + <code>seller_count</code> updated via <code>price-update</code> queue when listings change. Uses <code>algolia.partialUpdateObject()</code> to avoid re-indexing full record.</div>
        </div>
        <div class="note-item">
          <div class="note-label">Index size</div>
          <div class="note-text">~50,000 records at launch (NFR22). Algolia free tier supports 10,000 records ‚Äî paid plan needed. NFR25: index must support up to 1M records.</div>
        </div>
      </div>
    </div>
  </div>

</main>

<script>
function showPanel(id) {
  document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  const panel = document.getElementById(id);
  if (panel) panel.classList.add('active');
  const tabs = {
    'nav-search': 0, 'autocomplete': 1, 'results': 2,
    'no-results': 3, 'loading': 4, 'mobile': 5,
    'degraded': 6, 'index-spec': 7
  };
  const tabBtns = document.querySelectorAll('.tab-btn');
  if (tabs[id] !== undefined && tabBtns[tabs[id]]) {
    tabBtns[tabs[id]].classList.add('active');
  }
  window.scrollTo({ top: 0, behavior: 'smooth' });
}
</script>
</body>
</html>
